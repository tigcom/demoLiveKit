================================================================================
C√ÅC L·ªñI PH·ªî BI·∫æN V√Ä C√ÅCH S·ª¨A
================================================================================

N·∫øu g·∫∑p l·ªói khi ch·∫°y d·ª± √°n, h√£y t√¨m trong file n√†y.
M·ªói v·∫•n ƒë·ªÅ ƒë·ªÅu c√≥ c√°ch s·ª≠a c·ª• th·ªÉ.


================================================================================
L·ªñI LI√äN QUAN ƒê·∫æN C√ÄI ƒê·∫∂T
================================================================================

L·ªñI 1: "Python is not installed" ho·∫∑c "python: command not found"
  Nguy√™n nh√¢n: Python ch∆∞a ƒë∆∞·ª£c c√†i ho·∫∑c kh√¥ng th√™m v√†o PATH
  
  C√°ch s·ª≠a:
    1. Ki·ªÉm tra Python ƒë√£ c√†i ch∆∞a:
       - Tr√™n Windows: M·ªü Settings ‚Üí Apps ‚Üí Installed apps
       - T√¨m "Python" trong danh s√°ch
    
    2. N·∫øu ch∆∞a c√≥: C√†i Python t·ª´ https://www.python.org/downloads/
       - Nh·ªõ check "Add Python to PATH"
    
    3. Sau khi c√†i xong: M·ªü Command Prompt m·ªõi, g√µ:
       python --version
       
       N·∫øu th·∫•y "Python 3.11.xxx", l√† OK r·ªìi


L·ªñI 2: "Node is not installed" ho·∫∑c "node: command not found"
  Nguy√™n nh√¢n: Node.js ch∆∞a c√†i ho·∫∑c kh√¥ng th√™m v√†o PATH
  
  C√°ch s·ª≠a:
    1. Ki·ªÉm tra Node.js ƒë√£ c√†i ch∆∞a:
       - Tr√™n Windows: M·ªü Settings ‚Üí Apps ‚Üí Installed apps
       - T√¨m "Node.js" trong danh s√°ch
    
    2. N·∫øu ch∆∞a c√≥: C√†i Node.js t·ª´ https://nodejs.org/
    
    3. Sau khi c√†i xong: M·ªü Command Prompt m·ªõi, g√µ:
       node --version
       npm --version
       
       N·∫øu th·∫•y version s·ªë, l√† OK r·ªìi


L·ªñI 3: "ModuleNotFoundError: No module named 'livekit'"
  Nguy√™n nh√¢n: Th∆∞ vi·ªán LiveKit ch∆∞a c√†i ho·∫∑c virtual environment ch∆∞a k√≠ch ho·∫°t
  
  C√°ch s·ª≠a:
    1. Ki·ªÉm tra virtual environment ƒë√£ k√≠ch ho·∫°t ch∆∞a:
       - Nh√¨n v√†o Command Prompt
       - N·∫øu th·∫•y "(.venv)" ·ªü ƒë·∫ßu d√≤ng ‚Üí OK
       - N·∫øu kh√¥ng th·∫•y ‚Üí ch·∫°y: .venv\Scripts\activate
    
    2. Sau khi k√≠ch ho·∫°t, c√†i l·∫°i:
       pip install -r requirements.txt
    
    3. N·∫øu v·∫´n l·ªói, th·ª≠:
       pip install --upgrade pip
       pip install livekit fastapi uvicorn faster-whisper


L·ªñI 4: "No module named 'vite'" ho·∫∑c "vite: command not found"
  Nguy√™n nh√¢n: Th∆∞ vi·ªán frontend ch∆∞a c√†i
  
  C√°ch s·ª≠a:
    1. V√†o th∆∞ m·ª•c frontend:
       cd d:\project\livekit\livekit-voice-demo\frontend
    
    2. C√†i l·∫°i:
       npm install
    
    3. N·∫øu v·∫´n l·ªói, x√≥a node_modules r·ªìi c√†i l·∫°i:
       rmdir node_modules /s
       npm install


================================================================================
L·ªñI LI√äN QUAN ƒê·∫æN CH·∫†Y D·ª∞ √ÅN
================================================================================

L·ªñI 5: "Port 8000 is already in use"
  Nguy√™n nh√¢n: C·ªïng 8000 ƒëang b·ªã d√πng b·ªüi ch∆∞∆°ng tr√¨nh kh√°c
  
  C√°ch s·ª≠a - C√°ch 1 (thay c·ªïng):
    V√†o token_server.py, t√¨m d√≤ng:
      uvicorn token_server:app --port 8000
    
    Thay th√†nh:
      uvicorn token_server:app --port 8001
    
    R·ªìi m·ªü file .env ·ªü th∆∞ m·ª•c backend:
      Thay: TOKEN_SERVER_URL=http://localhost:8000
      Th√†nh: TOKEN_SERVER_URL=http://localhost:8001

  C√°ch s·ª≠a - C√°ch 2 (t√¨m ch∆∞∆°ng tr√¨nh d√πng c·ªïng):
    1. M·ªü Command Prompt as Administrator
    2. G√µ:
       netstat -ano | findstr :8000
    
    3. B·∫°n s·∫Ω th·∫•y m·ªôt PID (s·ªë hi·ªáu process)
    4. G√µ:
       taskkill /PID <PID> /F
       
       Thay <PID> b·∫±ng s·ªë b·∫°n t√¨m ƒë∆∞·ª£c


L·ªñI 6: "LLM/Transformers l·ªói ho·∫∑c connection failed"
  Nguy√™n nh√¢n: transformers/torch ch∆∞a c√†i, model ch∆∞a t·∫£i, ho·∫∑c l·ªói khi kh·ªüi t·∫°o pipeline
  
  C√°ch s·ª≠a:
    1. Ki·ªÉm tra virtualenv ƒë√£ activate v√† dependencies ƒë√£ c√†i:
       pip install -r requirements.txt
    2. Th·ª≠ ti·ªÅn t·∫£i model ki·ªÉm tra l·ªói:
       python -c "from transformers import pipeline; p=pipeline('text-generation', model='gpt2')"
    3. N·∫øu c√≥ l·ªói li√™n quan ƒë·∫øn torch, c√†i torch ph√π h·ª£p (xem docs/setup_and_install.txt)
    4. Ki·ªÉm tra log Python ƒë·ªÉ bi·∫øt chi ti·∫øt l·ªói (stacktrace)


L·ªñI 7: "Model not found / download failed"
  Nguy√™n nh√¢n: Model Transformers ch∆∞a t·∫£i v·ªÅ ho·∫∑c kh√¥ng th·ªÉ t·∫£i do m·∫°ng

  C√°ch s·ª≠a:
    1. Th·ª≠ ti·ªÅn t·∫£i model b·∫±ng l·ªánh:
       python -c "from transformers import pipeline; p=pipeline('text-generation', model='gpt2')"
    2. N·∫øu model l·ªõn, ch·ªù t·∫£i ho√†n t·∫•t (c√≥ th·ªÉ v√†i ph√∫t ƒë·∫øn v√†i GB)
    3. N·∫øu m·∫°ng ch·∫≠m, h√£y t·∫£i model tr√™n m·∫°ng c√≥ bƒÉng th√¥ng t·ªët r·ªìi di chuy·ªÉn cache
       (transformers d√πng cache t·∫°i %USERPROFILE%/.cache/huggingface)


L·ªñI 8: "Connection refused at localhost:5173"
  Nguy√™n nh√¢n: Frontend ch∆∞a ch·∫°y
  
  C√°ch s·ª≠a:
    1. M·ªü Command Prompt m·ªõi
    2. V√†o th∆∞ m·ª•c frontend:
       cd d:\project\livekit\livekit-voice-demo\frontend
    
    3. Ch·∫°y:
       npm run dev
    
    4. Ch·ªù ƒë·∫øn khi th·∫•y:
       ‚ûú  Local:   http://localhost:5173/
    
    5. Kh√¥ng ƒë√≥ng c·ª≠a s·ªï n√†y


L·ªñI 9: "Agent not connected to room"
  Nguy√™n nh√¢n: Token Server kh√¥ng ch·∫°y ho·∫∑c token kh√¥ng h·ª£p l·ªá
  
  C√°ch s·ª≠a:
    1. Ki·ªÉm tra Token Server c√≥ ch·∫°y kh√¥ng:
       - M·ªü tr√¨nh duy·ªát: http://localhost:8000/healthz
       - N·∫øu th·∫•y "OK", Token Server ch·∫°y OK
    
    2. Ki·ªÉm tra file .env:
       - M·ªü file backend/.env
       - Ch·∫Øc ch·∫Øn LIVEKIT_URL, LIVEKIT_API_KEY, LIVEKIT_API_SECRET ƒë√∫ng
    
    3. N·∫øu v·∫´n kh√¥ng OK, th·ª≠:
       python agent.py --livekit
       
       Nh√¨n v√†o log, xem l·ªói c·ª• th·ªÉ g√¨


================================================================================
L·ªñI LI√äN QUAN ƒê·∫æN √ÇM THANH
================================================================================

L·ªñI 10: "Microphone not working"
  Nguy√™n nh√¢n: Micro m√°y t√≠nh b·ªã t·∫Øt ho·∫∑c ch∆∞a c·∫•p quy·ªÅn truy c·∫≠p
  
  C√°ch s·ª≠a:
    1. Ki·ªÉm tra micro v·∫≠t l√Ω:
       - Ki·ªÉm tra d√¢y k·∫øt n·ªëi (n·∫øu l√† micro ngo√†i)
       - Ki·ªÉm tra Mute button tr√™n micro
    
    2. Ki·ªÉm tra c√†i ƒë·∫∑t Windows:
       - M·ªü: Settings ‚Üí Privacy & security ‚Üí Microphone
       - B·∫£o ƒë·∫£m microphone "ON"
       - B·∫£o ƒë·∫£m tr√¨nh duy·ªát c√≥ quy·ªÅn truy c·∫≠p micro
    
    3. Ki·ªÉm tra tr√¨nh duy·ªát:
       - M·ªü http://localhost:5173
       - Tr√¨nh duy·ªát s·∫Ω h·ªèi: "Allow access to microphone?"
       - Ch·ªçn "Allow"
    
    4. N·∫øu tr√¨nh duy·ªát kh√¥ng h·ªèi, reset permissions:
       - Chrome: Settings ‚Üí Privacy ‚Üí Site settings ‚Üí Microphone
       - X√≥a localhost:5173
       - Reload trang web


L·ªñI 11: "No audio received from agent"
  Nguy√™n nh√¢n: Agent nh·∫≠n ti·∫øng n√≥i nh∆∞ng kh√¥ng ph√°t √¢m thanh tr·∫£ l·ªùi
  
  C√°ch s·ª≠a:
    1. Ki·ªÉm tra loa m√°y t√≠nh:
       - Ki·ªÉm tra d√¢y k·∫øt n·ªëi (n·∫øu l√† loa ngo√†i)
       - Ki·ªÉm tra mute button
       - Ki·ªÉm tra √¢m l∆∞·ª£ng Windows (kh√¥ng ph·∫£i 0%)
    
    2. Ki·ªÉm tra Chrome settings:
       - M·ªü http://localhost:5173
       - F12 ‚Üí Console
       - T√¨m th√¥ng b√°o l·ªói li√™n quan ƒë·∫øn audio
    
    3. Ki·ªÉm tra STT/LLM/TTS ho·∫°t ƒë·ªông:
       - V√†o c·ª≠a s·ªï Agent
       - N√≥i g√¨ ƒë√≥ v√†o micro
       - Ki·ªÉm tra log:
         "üó£Ô∏è User said: ..."
         "üí¨ Agent reply: ..."
         "‚úì Published audio track: ..."
       
       - N·∫øu th·∫•y t·∫•t c·∫£ 3 d√≤ng n√†y, c√≥ nghƒ©a l√† STT/LLM/TTS OK
       - V·∫•n ƒë·ªÅ l√† ·ªü audio playback (ph√≠a frontend)


================================================================================
L·ªñI LI√äN QUAN ƒê·∫æN X·ª¨ L√ù TI·∫æNG N√ìI
================================================================================

L·ªñI 12: "STT failed: No module named 'faster_whisper'"
  Nguy√™n nh√¢n: faster-whisper ch∆∞a c√†i
  
  C√°ch s·ª≠a:
    pip install faster-whisper


L·ªñI 13: "TTS failed: No module named 'TTS'"
  Nguy√™n nh√¢n: Coqui TTS ch∆∞a c√†i
  
  C√°ch s·ª≠a:
    pip install TTS


L·ªñI 14: "STT model downloading... (takes time)"
  Nguy√™n nh√¢n: Model STT ƒëang t·∫£i l·∫ßn ƒë·∫ßu
  
  C√°ch s·ª≠a:
    - ƒê√¢y kh√¥ng ph·∫£i l·ªói, m√† l√† t√¨nh tr·∫°ng b√¨nh th∆∞·ªùng
    - L·∫ßn ƒë·∫ßu ch·∫°y, faster-whisper s·∫Ω t·∫£i model (~500MB)
    - Ch·ªù kho·∫£ng 5-10 ph√∫t
    - L·∫ßn sau s·∫Ω nhanh h∆°n


L·ªñI 15: "Agent reply is empty or stuttering"
  Nguy√™n nh√¢n: LLM pipeline tr·∫£ v·ªÅ chu·ªói r·ªóng, TTS g·∫∑p l·ªói, ho·∫∑c audio I/O kh√¥ng ·ªïn

  C√°ch s·ª≠a:
    1. Ki·ªÉm tra log Agent ƒë·ªÉ xem b∆∞·ªõc n√†o b·ªã l·ªói (STT / LLM / TTS)
    2. Ki·ªÉm tra LLM: ch·∫°y l·ªánh ki·ªÉm tra nh·ªè ƒë·ªÉ x√°c nh·∫≠n pipeline ho·∫°t ƒë·ªông
       python -c "from transformers import pipeline; p=pipeline('text-generation', model='gpt2'); print(p('test', max_new_tokens=10))"
    3. Ki·ªÉm tra TTS: th·ª≠ synthesize m·ªôt ƒëo·∫°n vƒÉn ƒë∆°n gi·∫£n b·∫±ng test_pipeline.py
       python test_pipeline.py --sample sample.wav --mock-llm
    4. N·∫øu v·∫´n l·ªói, thu th·∫≠p log v√† th√¥ng b√°o chi ti·∫øt (traceback)


================================================================================
L·ªñI LI√äN QUAN ƒê·∫æN K·∫æT N·ªêI
================================================================================

L·ªñI 16: "Connection to LiveKit failed"
  Nguy√™n nh√¢n: LiveKit URL kh√¥ng ƒë√∫ng ho·∫∑c token kh√¥ng h·ª£p l·ªá
  
  C√°ch s·ª≠a:
    1. Ki·ªÉm tra file .env:
       - LIVEKIT_URL: Ch·∫Øc ch·∫Øn URL ƒë√∫ng
       - LIVEKIT_API_KEY: Ch·∫Øc ch·∫Øn API key ƒë√∫ng
       - LIVEKIT_API_SECRET: Ch·∫Øc ch·∫Øn API secret ƒë√∫ng
    
    2. Ki·ªÉm tra Token Server:
       - M·ªü: http://localhost:8000/healthz
       - N·∫øu kh√¥ng k·∫øt n·ªëi, ch·∫°y l·∫°i token server
    
    3. Test token:
       - G√µ:
         curl -X POST http://localhost:8000/api/get_token -H "Content-Type: application/json" -d "{\"room\":\"demo-room\",\"identity\":\"test-user\"}"
       
       - N·∫øu c√≥ ph·∫£n h·ªìi token, Token Server OK


L·ªñI 17: "Frontend cannot find room"
  Nguy√™n nh√¢n: Room ch∆∞a t·ªìn t·∫°i tr√™n LiveKit
  
  C√°ch s·ª≠a:
    1. Ki·ªÉm tra ROOM trong .env:
       - Ch·∫Øc ch·∫Øn ROOM = "demo-room" (ho·∫∑c t√™n room kh√°c)
    
    2. N·∫øu d√πng LiveKit Cloud:
       - Truy c·∫≠p: https://cloud.livekit.io
       - ƒêƒÉng nh·∫≠p v·ªõi API key/secret
       - Ki·ªÉm tra room c√≥ t·ªìn t·∫°i kh√¥ng
    
    3. N·∫øu d√πng LiveKit self-hosted:
       - Ki·ªÉm tra LiveKit server c√≥ ch·∫°y kh√¥ng


================================================================================
L·ªñI LI√äN QUAN ƒê·∫æN T·∫¨P TIN
================================================================================

L·ªñI 18: "File not found: .env"
  Nguy√™n nh√¢n: File .env ch∆∞a t·∫°o
  
  C√°ch s·ª≠a:
    1. V√†o th∆∞ m·ª•c backend:
       cd d:\project\livekit\livekit-voice-demo\backend
    
    2. T√¨m file .env.example
    
    3. Sao ch√©p n√≥:
       copy .env.example .env
    
    4. M·ªü file .env b·∫±ng Notepad
    
    5. Ch·ªânh s·ª≠a n·∫øu c·∫ßn
    
    6. L∆∞u file


L·ªñI 19: "Permission denied" khi ch·∫°y python script
  Nguy√™n nh√¢n: Quy·ªÅn truy c·∫≠p file kh√¥ng ƒë·ªß
  
  C√°ch s·ª≠a:
    1. M·ªü Command Prompt as Administrator
    2. G√µ l·∫°i l·ªánh:
       python agent.py --livekit


================================================================================
L·ªñI HI·∫æM G·∫∂P
================================================================================

L·ªñI 20: "ValueError: malformed node or string"
  Nguy√™n nh√¢n: File .env c√≥ k√Ω t·ª± ƒë·∫∑c bi·ªát ho·∫∑c ƒë·ªãnh d·∫°ng sai
  
  C√°ch s·ª≠a:
    1. M·ªü file .env b·∫±ng Notepad
    2. Ch·∫Øc ch·∫Øn kh√¥ng c√≥ tab, ch·ªâ c√≥ space
    3. M·ªói d√≤ng ph·∫£i c√≥ ƒë·ªãnh d·∫°ng: KEY=VALUE
    4. Kh√¥ng c√≥ kho·∫£ng tr·∫Øng xung quanh d·∫•u =
    5. L∆∞u file (save as UTF-8 n·∫øu c·∫ßn)


L·ªñI 21: "RecursionError: maximum recursion depth exceeded"
  Nguy√™n nh√¢n: Code b·ªã l·∫∑p v√¥ h·∫°n (r·∫•t hi·∫øm)
  
  C√°ch s·ª≠a:
    - B√°o l·ªói n√†y cho team development
    - ƒê√¢y l√† l·ªói code, kh√¥ng ph·∫£i c√†i ƒë·∫∑t


================================================================================
KH√îNG T√åM TH·∫§Y L·ªñI C·ª¶A B·∫†N?
================================================================================

N·∫øu l·ªói c·ªßa b·∫°n kh√¥ng c√≥ trong danh s√°ch n√†y, h√£y:

1. Ki·ªÉm tra l·∫°i t·∫•t c·∫£ b∆∞·ªõc c√†i ƒë·∫∑t (xem setup_and_install.txt)

2. D·ª´ng t·∫•t c·∫£ ch∆∞∆°ng tr√¨nh, m·ªü Command Prompt m·ªõi, ch·∫°y l·∫°i t·ª´ ƒë·∫ßu

3. Ki·ªÉm tra c√°c log:
   - C·ª≠a s·ªï Ollama: C√≥ l·ªói g√¨ kh√¥ng?
   - C·ª≠a s·ªï Token Server: C√≥ l·ªói g√¨ kh√¥ng?
   - C·ª≠a s·ªï Frontend: C√≥ l·ªói g√¨ kh√¥ng?
   - C·ª≠a s·ªï Agent: C√≥ l·ªói g√¨ kh√¥ng?
   - Browser Console (F12): C√≥ l·ªói g√¨ kh√¥ng?


4. N·∫øu v·∫´n kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c:
   - Ghi l·∫°i th√¥ng b√°o l·ªói ch√≠nh x√°c
   - Ghi l·∫°i nh·ªØng b∆∞·ªõc b·∫°n ƒë√£ th·ª±c hi·ªán
   - Ki·ªÉm tra c√°c log li√™n quan: Token Server, Frontend, Agent
   - N·∫øu c·∫ßn, g·ª≠i log cho team development

================================================================================
G·ª¢I √ù: T·ª®C ƒê∆†NGI·∫¢N H√ìA TR·ª® TR·ª® CHI
================================================================================

N·∫øu g·∫∑p qu√° nhi·ªÅu l·ªói, h√£y th·ª≠ c√°ch ƒë∆°n gi·∫£n:

1. X√≥a th∆∞ m·ª•c backend/.venv
2. X√≥a th∆∞ m·ª•c frontend/node_modules
3. C√†i ƒë·∫∑t l·∫°i t·ª´ ƒë·∫ßu (xem setup_and_install.txt)

ƒêi·ªÅu n√†y gi√∫p "reset" l·∫°i to√†n b·ªô c√†i ƒë·∫∑t.

================================================================================
